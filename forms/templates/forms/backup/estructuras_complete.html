<!-- Wrapper del formulario completo -->
<div id="form-total">
  <!-- Sección: Información del Proyecto -->
  <div class="bg-white rounded-lg shadow-sm p-8 mb-8">
    <h2 class="text-xl font-semibold mb-6 flex items-center text-blue-600">
      <i class="fas fa-project-diagram mr-2"></i>
      Información del Proyecto
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <div class="form-group">
        <label class="form-label required">
          NOMBRE DEL PROYECTO
          <span class="tooltip">
            <i class="fas fa-question-circle help-icon"></i>
            <span class="tooltip-content">
              Selecciona el proyecto específico al que pertenece esta
              estructura. El proyecto determina el banco y los contratos
              disponibles.
            </span>
          </span>
        </label>
        <select id="nombre" name="nombre" class="form-select" required>
          <option value="">Seleccionar proyecto</option>
          <option value="Automatización de redes distribución CENS">
            Automatización de redes distribución CENS
          </option>
          <option value="Compra de bien futuro">Compra de bien futuro</option>
          <option value="Electrificación Rural CENS">
            Electrificación Rural CENS
          </option>
          <option value="Expansión redes de distribución CENS">
            Expansión redes de distribución CENS
          </option>
          <option value="Gestión y control pérdidas de energía - CENS">
            Gestión y control pérdidas de energía - CENS
          </option>
          <option value="Mantenimiento redes de distribución">
            Mantenimiento redes de distribución
          </option>
          <option value="Mantenimiento redes de distribución - MIT">
            Mantenimiento redes de distribución - MIT
          </option>
          <option
            value="Normalización subestación Sevilla 115/34.5 kV e interconexión a 115 kV"
          >
            Normalización subestación Sevilla 115/34.5 kV e interconexión a 115
            kV
          </option>
          <option value="Nueva línea INSC77 - Guaduas 34.5 kV">
            Nueva línea INSC77 - Guaduas 34.5 kV
          </option>
          <option value="Nuevo Alimentador Gabarra">
            Nuevo Alimentador Gabarra
          </option>
          <option value="Reconfiguración Planta Zulia 13.8kV">
            Reconfiguración Planta Zulia 13.8kV
          </option>
          <option value="Reposición redes de distribución CENS">
            Reposición redes de distribución CENS
          </option>
          <option value="Reposición transformadores distribución CENS">
            Reposición transformadores distribución CENS
          </option>
          <option value="Repotenciación de líneas CENS 115 kV">
            Repotenciación de líneas CENS 115 kV
          </option>
          <option value="Reposición subestaciones y líneas CENS">
            Reposición subestaciones y líneas CENS
          </option>
          <option
            value="Expansión y normalización de subestaciones media tensión."
          >
            Expansión y normalización de subestaciones media tensión.
          </option>
          <option value="Nueva subestación La Playa 34.5/13.8 kV">
            Nueva subestación La Playa 34.5/13.8 kV
          </option>
          <option value="Gestión de Activos CENS">
            Gestión de Activos CENS
          </option>
          <option value="Activos de Uso propiedad de Terceros">
            Activos de Uso propiedad de Terceros
          </option>
        </select>
      </div>

      <div class="form-group">
        <label class="form-label">
          BANCO DEL PROYECTO
          <span class="tooltip">
            <i class="fas fa-question-circle help-icon"></i>
            <span class="tooltip-content">
              Código del banco asociado al proyecto. Se autocompletará
              automáticamente cuando selecciones un proyecto.
            </span>
          </span>
        </label>
        <input
          type="text"
          id="banco_proyecto"
          name="banco_proyecto"
          class="form-input bg-gray-50"
          placeholder="Se autocompletará según el proyecto"
          readonly
        />
      </div>

      <div class="form-group">
        <label class="form-label required">
          CONTRATO
          <span class="tooltip">
            <i class="fas fa-question-circle help-icon"></i>
            <span class="tooltip-content">
              Contrato específico del proyecto. Determina qué municipios estarán
              disponibles según la regional asignada.
            </span>
          </span>
        </label>
        <select id="contrato" name="contrato" class="form-select" required>
          <option value="">Seleccionar contrato</option>
          <!-- Las opciones se cargarán dinámicamente según el proyecto seleccionado -->
        </select>
      </div>
    </div>
  </div>

  <!-- Sección: Documentos y Archivos - Conductores -->
  <div class="bg-white rounded-lg shadow-sm p-8 mb-8">
    <h2 class="text-xl font-semibold mb-6 flex items-center text-blue-600">
      <i class="fas fa-file-alt mr-2"></i>
      Documentos y Archivos
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
      <!-- AutoCAD -->
      <div class="space-y-4">
        <label class="form-label required">
          ARCHIVO AUTOCAD
          <span class="tooltip">
            <i class="fas fa-question-circle help-icon"></i>
            <span class="tooltip-content">
              Archivo de diseño técnico en formato AutoCAD (.dwg, .dxf, .dws).
              Debe contener el plano de la estructura. Tamaño máximo: 10MB.
            </span>
          </span>
        </label>
        <div class="flex items-center justify-center w-full">
          <label
            for="archivo_cad"
            class="flex flex-col items-center justify-center w-full h-40 border-2 border-blue-300 border-dashed rounded-lg cursor-pointer bg-blue-50 hover:bg-blue-100 dark:border-blue-600 dark:hover:border-blue-500"
          >
            <div class="flex flex-col items-center justify-center pt-5 pb-6">
              <svg
                class="w-8 h-8 mb-4 text-blue-500"
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 20 16"
              >
                <path
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"
                />
              </svg>
              <p class="mb-2 text-sm text-blue-600">
                <span class="font-semibold">Click to upload</span> or drag and
                drop
              </p>
              <p class="text-xs text-blue-500">DWG, DXF, DWS • Máximo 10MB</p>
            </div>
            <input
              id="archivo_cad"
              name="archivo_cad"
              type="file"
              accept=".dwg,.dxf,.dws"
              class="hidden"
              required
            />
          </label>
        </div>
        <!-- Preview AutoCAD -->
        <div id="cad_preview" class="hidden">
          <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <i class="fas fa-file-alt text-blue-600 mr-2"></i>
                <span
                  class="text-sm font-medium text-gray-700"
                  id="cad_filename"
                ></span>
              </div>
              <button
                type="button"
                class="text-red-600 hover:text-red-800"
                onclick="removeFile('archivo_cad')"
              >
                <i class="fas fa-times"></i>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- KMZ -->
      <div class="space-y-4">
        <label class="form-label required">
          ARCHIVO KMZ (.kmz)
          <span class="tooltip">
            <i class="fas fa-question-circle help-icon"></i>
            <span class="tooltip-content">
              Sube el archivo de ubicación geográfica de los conductores.
              Formato aceptado: .kmz (máximo 10MB)
            </span>
          </span>
        </label>
        <div class="flex items-center justify-center w-full">
          <label
            for="archivo_kmz"
            class="flex flex-col items-center justify-center w-full h-40 border-2 border-green-300 border-dashed rounded-lg cursor-pointer bg-green-50 hover:bg-green-100 dark:border-green-600 dark:hover:border-green-500"
          >
            <div class="flex flex-col items-center justify-center pt-5 pb-6">
              <svg
                class="w-8 h-8 mb-4 text-green-500"
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 20 16"
              >
                <path
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"
                />
              </svg>
              <p class="mb-2 text-sm text-green-600">
                <span class="font-semibold">Click to upload</span> or drag and
                drop
              </p>
              <p class="text-xs text-green-500">KMZ • Máximo 10MB</p>
            </div>
            <input
              id="archivo_kmz"
              name="archivo_kmz"
              type="file"
              accept=".kmz"
              class="hidden"
              required
            />
          </label>
        </div>
        <!-- Preview KMZ -->
        <div id="kmz_preview" class="hidden">
          <div class="bg-green-50 border border-green-200 rounded-lg p-3">
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <i class="fas fa-map-marked-alt text-green-600 mr-2"></i>
                <span
                  class="text-sm font-medium text-gray-700"
                  id="kmz_filename"
                ></span>
              </div>
              <button
                type="button"
                class="text-red-600 hover:text-red-800"
                onclick="removeFile('archivo_kmz')"
              >
                <i class="fas fa-times"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Sección: Información Técnica -->
  <div
    class="bg-white rounded-lg shadow-sm p-8 mb-8"
    id="seccion-informacion-tecnica"
  >
    <h2 class="text-xl font-semibold mb-6 flex items-center text-blue-600">
      <i class="fas fa-bolt mr-2"></i>
      Información Técnica
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <div class="form-group">
        <label class="form-label required">
          FECHA DE INSTALACION
          <span class="tooltip">
            <i class="fas fa-question-circle help-icon"></i>
            <span class="tooltip-content">
              Fecha en la que se instaló. No puede ser posterior a la fecha
              actual.
            </span>
          </span>
        </label>
        <input
          type="date"
          id="fecha"
          name="fecha"
          class="form-input"
          required
        />
      </div>

      <div class="form-group">
        <label class="form-label required">
          NIVEL DE TENSIÓN
          <span class="tooltip">
            <i class="fas fa-question-circle help-icon"></i>
            <span class="tooltip-content">
              Nivel de tensión eléctrica: 1-Baja Tensión (hasta 1kV), 2-Media
              Tensión (1-35kV), 3-Alta Tensión (mayor a 35kV).
            </span>
          </span>
        </label>
        <select
          id="nivel_tension"
          name="nivel_tension"
          class="form-select"
          required
        >
          <option value="">Seleccionar</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
        </select>
      </div>

      <div class="form-group">
        <label class="form-label required">
          TIPO DE INVERSION
          <span class="tooltip">
            <i class="fas fa-question-circle help-icon"></i>
            <span class="tooltip-content">
              Tipo de inversión: I y III requieren estructura retirada, II y IV
              son instalaciones nuevas sin retirar estructura existente.
            </span>
          </span>
        </label>
        <div class="flex items-start gap-4">
          <div class="flex-1">
            <select id="t_inv" name="t_inv" class="form-select" required>
              <option value="">Seleccionar</option>
              <option value="I">I</option>
              <option value="II">II</option>
              <option value="III">III</option>
              <option value="IV">IV</option>
            </select>
          </div>

          <!-- Checkbox Montaje Integral -->
          <div
            class="flex items-center space-x-2"
            id="montaje_integral_container"
            style="display: none"
          >
            <input
              type="checkbox"
              id="montaje_integral_checkbox"
              name="montaje_integral"
              class="h-4 w-4 text-orange-600 focus:ring-orange-500 border-gray-300 rounded"
              onchange="toggleMontajeIntegral()"
            />
            <label
              for="montaje_integral_checkbox"
              class="text-sm text-orange-700 flex items-center gap-1"
            >
              <i class="fas fa-tools text-xs"></i>
              Montaje Integral
            </label>
          </div>

          <!-- Checkbox Desmantelado -->
          <div
            class="flex items-center space-x-2"
            id="desmantelado_container"
            style="display: none"
          >
            <input
              type="checkbox"
              id="desmantelado_checkbox"
              name="desmantelado"
              class="h-4 w-4 text-red-600 focus:ring-red-500 border-gray-300 rounded"
              onchange="toggleDesmantelado()"
            />
            <label
              for="desmantelado_checkbox"
              class="text-sm text-red-700 flex items-center gap-1"
            >
              <i class="fas fa-exclamation-triangle text-xs"></i>
              Desmantelado
            </label>
          </div>
        </div>

        <!-- Textos de ayuda -->
        <div class="flex gap-4 mt-1">
          <div class="flex-1"></div>
          <div
            class="text-xs text-gray-500 text-center"
            id="montaje_integral_help"
            style="display: none"
          >
            Deshabilita UC
          </div>
          <div
            class="text-xs text-gray-500 text-center"
            id="desmantelado_help"
            style="display: none"
          >
            Solo estructura retirada
          </div>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label required">
          MUNICIPIO
          <span class="tooltip">
            <i class="fas fa-question-circle help-icon"></i>
            <span class="tooltip-content">
              Municipio donde se instalará la estructura. Los municipios
              disponibles dependen de la regional seleccionada.
            </span>
          </span>
        </label>
        <select id="municipio" name="municipio" class="form-select" required>
          <option value="">Seleccionar municipio</option>
        </select>
      </div>

      <div class="form-group">
        <label class="form-label required">
          DEPARTAMENTO
          <span class="tooltip">
            <i class="fas fa-question-circle help-icon"></i>
            <span class="tooltip-content">
              Departamento donde se encuentra el municipio seleccionado. Se
              autocompletará según el municipio.
            </span>
          </span>
        </label>
        <input
          type="text"
          id="departamento"
          name="departamento"
          class="form-input bg-gray-50"
          placeholder="Se autocompletará según el municipio"
          readonly
          required
        />
      </div>

      <div class="form-group">
        <label class="form-label required">
          REGIONAL
          <span class="tooltip">
            <i class="fas fa-question-circle help-icon"></i>
            <span class="tooltip-content">
              Regional responsable del proyecto. Se autocompletará según el
              contrato o municipio seleccionado.
            </span>
          </span>
        </label>
        <input
          type="text"
          id="regional"
          name="regional"
          class="form-input bg-gray-100 text-gray-500 cursor-not-allowed"
          placeholder="Se autocompletará según contrato o municipio"
          readonly
          required
        />
      </div>

      <div class="form-group">
        <label class="form-label required">DIRECCIÓN</label>
        <input
          type="text"
          id="direccion"
          name="direccion"
          class="form-input"
          placeholder="Dirección completa"
          required
        />
      </div>

      <div class="form-group">
        <label class="form-label required">
          CIRCUITO
          <span class="tooltip">
            <i class="fas fa-question-circle help-icon"></i>
            <span class="tooltip-content">
              Circuito eléctrico (alimentador) al que se conecta la estructura.
              Se actualiza automáticamente según el municipio seleccionado.
            </span>
          </span>
        </label>
        <select
          id="alimentador"
          name="alimentador"
          class="form-select"
          required
        >
          <option value="">Seleccionar</option>
        </select>
      </div>

      <div class="form-group">
        <label class="form-label required">
          ESTRUCTURA RETIRADA
          <span class="tooltip">
            <i class="fas fa-question-circle help-icon"></i>
            <span class="tooltip-content">
              Código de la estructura que se retira. Solo se habilita para tipos
              de inversión I y III. Debe empezar con "Z" seguido de números.
            </span>
          </span>
        </label>
        <div class="space-y-3">
          <input
            type="text"
            id="estructura_retirada_campo"
            name="estructura_retirada_campo"
            class="form-input bg-yellow-50"
            placeholder="Z10000"
            disabled
          />
        </div>
      </div>

      <!-- Campos de coordenadas -->
      <div class="md:col-span-3">
        <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4">
          <div class="form-group">
            <label class="form-label required" id="longitud_label">
              LONGITUD
              <span class="tooltip">
                <i class="fas fa-question-circle help-icon"></i>
                <span class="tooltip-content">
                  Coordenada de Longitud (grados decimales) de la ubicación en
                  Colombia. Rango válido: -79.0 a -66.8 (valores negativos hacia
                  el oeste).
                </span>
              </span>
            </label>
            <input
              type="number"
              id="longitud"
              name="longitud"
              class="form-input"
              placeholder="-74.0721"
              step="0.000001"
              required
              oninput="validateCoordinate(this, 'longitud')"
            />
          </div>

          <div class="form-group">
            <label class="form-label required" id="latitud_label">
              LATITUD
              <span class="tooltip">
                <i class="fas fa-question-circle help-icon"></i>
                <span class="tooltip-content">
                  Coordenada de Latitud (grados decimales) de la ubicación en
                  Colombia. Rango válido: -4.2 a 15.5 (positivo hacia el norte).
                </span>
              </span>
            </label>
            <input
              type="number"
              id="latitud"
              name="latitud"
              class="form-input"
              placeholder="4.7110"
              step="0.000001"
              required
              oninput="validateCoordinate(this, 'latitud')"
            />
          </div>

          <div
            class="form-group"
            id="longitud_final_group"
            style="display: none"
          >
            <label class="form-label" id="longitud_final_label">
              LONGITUD FINAL
              <span class="tooltip">
                <i class="fas fa-question-circle help-icon"></i>
                <span class="tooltip-content">
                  Coordenada de Longitud Final (grados decimales) de la
                  ubicación final en Colombia. Rango válido: -79.0 a -66.8
                  (valores negativos hacia el oeste).
                </span>
              </span>
            </label>
            <input
              type="number"
              id="longitud_final"
              name="longitud_final"
              class="form-input"
              placeholder="-74.0721"
              step="0.000001"
              min="-79.0"
              max="-66.8"
              oninput="validateCoordinate(this, 'longitud')"
            />
          </div>

          <div
            class="form-group"
            id="latitud_final_group"
            style="display: none"
          >
            <label class="form-label" id="latitud_final_label">
              LATITUD FINAL
              <span class="tooltip">
                <i class="fas fa-question-circle help-icon"></i>
                <span class="tooltip-content">
                  Coordenada de Latitud Final (grados decimales) de la ubicación
                  final en Colombia. Rango válido: -4.2 a 15.5 (positivo hacia
                  el norte).
                </span>
              </span>
            </label>
            <input
              type="number"
              id="latitud_final"
              name="latitud_final"
              class="form-input"
              placeholder="4.7110"
              step="0.000001"
              min="-4.2"
              max="15.5"
              oninput="validateCoordinate(this, 'latitud')"
            />
          </div>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label required">CANTIDAD TOTAL</label>
        <input
          type="number"
          id="cantidad"
          name="cantidad"
          class="form-input"
          placeholder="1"
          min="1"
          value="1"
          required
        />
      </div>

      <div class="form-group">
        <label class="form-label required">NÚMERO DE CONDUCTORES</label>
        <input
          type="text"
          id="numero_conductores"
          name="numero_conductores"
          class="form-input"
          placeholder="0"
          value="0"
        />
      </div>
    </div>
  </div>

  <!-- Sección: Información de Estructuras -->
  <div
    class="bg-white rounded-lg shadow-sm p-8 mb-8"
    id="seccion-informacion-estructuras"
  >
    <h2 class="text-xl font-semibold mb-6 flex items-center text-blue-600">
      <i class="fas fa-building mr-2"></i>
      Información de Estructuras
    </h2>

    <!-- Contenedor de campos de estructuras -->
    <div id="form-uc">
      <!-- Estructura Nueva -->
      <div
        class="bg-emerald-50/50 rounded-lg border border-emerald-200 p-6 mb-6"
      >
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <!-- Campo APOYO (Nuevo campo principal) -->
          <div class="form-group">
            <label class="form-label required">
              TIPO DE APOYO
              <span class="tooltip">
                <i class="fas fa-question-circle help-icon"></i>
                <span class="tooltip-content">
                  Tipo de apoyo de la estructura: Poste (N1/N2), Estructura
                  (N3/N4), Torrecilla (N3), Torre (N4).
                </span>
              </span>
            </label>
            <select
              id="apoyo_nueva"
              name="apoyo_nueva"
              class="form-select"
              required
            >
              <option value="">Seleccionar apoyo</option>
              <option value="Poste">POSTE</option>
              <option value="Estructura">ESTRUCTURA</option>
              <option value="Torrecilla">TORRECILLA</option>
              <option value="Torre">TORRE</option>
            </select>
          </div>

          <!-- Campo MATERIAL DE LA ESTRUCTURA -->
          <div class="form-group">
            <label class="form-label required">MATERIAL DE LA ESTRUCTURA</label>
            <select
              id="material_nueva"
              name="material_nueva"
              class="form-select"
              required
            >
              <option value="">Seleccionar material</option>
              <option value="Concreto">CONCRETO</option>
              <option value="Madera">MADERA</option>
              <option value="Metálico">METÁLICO</option>
              <option value="Fibra de vidrio">FIBRA DE VIDRIO</option>
              <option value="PRFV">PRFV</option>
            </select>
          </div>

          <!-- Campo ALTURA TOTAL -->
          <div class="form-group">
            <label class="form-label required">ALTURA TOTAL (m)</label>
            <select
              id="altura_nueva"
              name="altura_nueva"
              class="form-select"
              required
            >
              <option value="">Seleccionar altura</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
              <option value="11">11</option>
              <option value="12">12</option>
              <option value="13">13</option>
              <option value="14">14</option>
              <option value="15">15</option>
              <option value="16">16</option>
              <option value="25">25</option>
              <option value="27">27</option>
              <option value="29">29</option>
            </select>
          </div>

          <!-- Campo PESO (Para niveles N2, N3, N4) -->
          <div class="form-group" id="peso_group" style="display: none">
            <label class="form-label">
              PESO (kg)
              <span class="tooltip">
                <i class="fas fa-question-circle help-icon"></i>
                <span class="tooltip-content">
                  Peso de la estructura en kilogramos. Aplica para estructuras
                  de nivel 2, 3 y 4.
                </span>
              </span>
            </label>
            <select id="peso_nueva" name="peso_nueva" class="form-select">
              <option value="">Seleccionar peso</option>
              <option value="510">510 kg</option>
              <option value="750">750 kg</option>
              <option value="1050">1050 kg</option>
              <option value="1350">1350 kg</option>
              <option value="1500">1500 kg</option>
              <option value="2000">2000 kg</option>
              <option value="3000">3000 kg</option>
              <option value="4000">4000 kg</option>
            </select>
          </div>

          <!-- Campo CONFIGURACIÓN (Para niveles N3, N4) -->
          <div
            class="form-group"
            id="configuracion_group"
            style="display: none"
          >
            <label class="form-label">
              CONFIGURACIÓN
              <span class="tooltip">
                <i class="fas fa-question-circle help-icon"></i>
                <span class="tooltip-content">
                  Configuración de los postes: Simple o en H (para estructuras
                  N3).
                </span>
              </span>
            </label>
            <select
              id="configuracion_nueva"
              name="configuracion_nueva"
              class="form-select"
            >
              <option value="">Seleccionar configuración</option>
              <option value="Simple">POSTE SIMPLE</option>
              <option value="H">POSTES EN H</option>
            </select>
          </div>

          <!-- Campo TIPO DE CIRCUITO (Para niveles N3, N4) -->
          <div class="form-group" id="circuito_group" style="display: none">
            <label class="form-label">
              TIPO DE CIRCUITO
              <span class="tooltip">
                <i class="fas fa-question-circle help-icon"></i>
                <span class="tooltip-content">
                  Tipo de circuito: Sencillo o Doble (para estructuras N3 y N4).
                </span>
              </span>
            </label>
            <select
              id="circuito_nueva"
              name="circuito_nueva"
              class="form-select"
            >
              <option value="">Seleccionar circuito</option>
              <option value="Sencillo">CIRCUITO SENCILLO</option>
              <option value="Doble">CIRCUITO DOBLE</option>
            </select>
          </div>

          <!-- Campo TIPO DE LÍNEA (Para nivel N4) -->
          <div class="form-group" id="linea_group" style="display: none">
            <label class="form-label">
              TIPO DE LÍNEA
              <span class="tooltip">
                <i class="fas fa-question-circle help-icon"></i>
                <span class="tooltip-content">
                  Tipo de línea aérea: Desnuda o Compacta (para estructuras N4).
                </span>
              </span>
            </label>
            <select id="linea_nueva" name="linea_nueva" class="form-select">
              <option value="">Seleccionar línea</option>
              <option value="Desnuda">LINEA AEREA DESNUDA</option>
              <option value="Compacta">LINEA AEREA COMPACTA</option>
            </select>
          </div>

          <!-- Campos para N1 únicamente -->
          <div class="form-group" id="poblacion_group">
            <label class="form-label required">POBLACIÓN</label>
            <select
              id="poblacion_nueva"
              name="poblacion_nueva"
              class="form-select"
              required
            >
              <option value="">Seleccionar población</option>
              <option value="Urbana">URBANA</option>
              <option value="Rural">RURAL</option>
            </select>
          </div>

          <div class="form-group" id="tipo_red_group">
            <label class="form-label required">TIPO DE RED</label>
            <select
              id="tipo_red_nueva"
              name="tipo_red_nueva"
              class="form-select"
              required
            >
              <option value="">Seleccionar tipo</option>
              <option value="Común">COMÚN</option>
              <option value="Trenzada">TRENZADA</option>
            </select>
          </div>

          <!-- Campo DISPOSICIÓN (Universal) -->
          <div class="form-group">
            <label class="form-label required">DISPOSICIÓN</label>
            <select
              id="disposicion_nueva"
              name="disposicion_nueva"
              class="form-select"
              required
            >
              <option value="">Seleccionar disposición</option>
              <option value="Suspensión">SUSPENSIÓN</option>
              <option value="Retención">RETENCIÓN</option>
            </select>
          </div>

          <!-- Campo UC (Universal) -->
          <div class="form-group">
            <label class="form-label">
              UC (Código Único)
              <span class="tooltip">
                <i class="fas fa-question-circle help-icon"></i>
                <span class="tooltip-content">
                  Código único que se genera automáticamente según los
                  parámetros seleccionados.
                </span>
              </span>
            </label>
            <input
              type="text"
              id="uc_nueva"
              name="uc_nueva"
              class="form-input bg-blue-50"
              placeholder="Se generará automáticamente"
              readonly
            />
          </div>
        </div>

        <!-- Fotos -->
        <div class="mt-6">
          <label class="form-label required">Fotografías</label>
          <div class="flex items-center justify-center w-full">
            <label
              for="fotos"
              class="flex flex-col items-center justify-center w-full h-40 border-2 border-yellow-300 border-dashed rounded-lg cursor-pointer bg-green-50 hover:bg-green-100 dark:border-green-600 dark:hover:border-green-500"
            >
              <div class="flex flex-col items-center justify-center pt-5 pb-6">
                <svg
                  class="w-8 h-8 mb-4 text-green-500"
                  aria-hidden="true"
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 20 16"
                >
                  <path
                    stroke="currentColor"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"
                  />
                </svg>
                <p class="mb-2 text-sm text-green-600">
                  <span class="font-semibold">Click para subir</span> o arrastra y
                  suelta
                </p>
                <p class="text-xs text-green-500">
                  JPG, PNG • Múltiples archivos • Máximo 5MB cada uno
                </p>
              </div>
              <input
                id="fotos"
                name="fotos"
                type="file"
                accept="image/*"
                multiple
                class="hidden"
                required
              />
            </label>
          </div>
          <div
            id="preview"
            class="grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-6 gap-4 mt-4"
          ></div>
        </div>

        <!-- Botón Agregar Iteración -->
        <div class="mt-6 flex justify-end">
          <button
            type="button"
            id="agregarIteracion"
            class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2"
          >
            <i class="fas fa-plus"></i>
            Agregar Iteración
          </button>
        </div>
      </div>
    </div>

    <!-- Tabla de iteraciones -->
    <div class="bg-white rounded-lg shadow-sm p-8 mb-8">
      <h2 class="text-xl font-semibold mb-6 flex items-center text-blue-600">
        <i class="fas fa-table mr-2"></i>
        Registro de Iteraciones
      </h2>

      <div class="overflow-x-auto rounded-lg border border-gray-200">
        <table class="min-w-full divide-y divide-gray-200">
          <thead>
            <tr>
              <th
                colspan="4"
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-amber-50"
              >
                Estructura Retirada
              </th>
              <th
                colspan="6"
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-emerald-50"
              >
                Estructura Nueva
              </th>
              <th
                rowspan="2"
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50"
              >
                Acciones
              </th>
            </tr>
            <tr>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-amber-50"
              >
                Material
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-amber-50"
              >
                Altura
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-amber-50"
              >
                Apoyo
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-amber-50"
              >
                UC
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-emerald-50"
              >
                Material
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-emerald-50"
              >
                Altura
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-emerald-50"
              >
                Población
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-emerald-50"
              >
                Disposición
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-emerald-50"
              >
                Apoyo
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-emerald-50"
              >
                UC
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-emerald-50"
              >
                Fotos
              </th>
            </tr>
          </thead>
          <tbody
            id="iterationTableBody"
            class="bg-white divide-y divide-gray-200"
          >
            <!-- Las filas se agregarán dinámicamente aquí -->
          </tbody>
        </table>
      </div>
    </div>
    <!-- Fin contenedor form-uc -->
  </div>
</div>
<!-- Fin del wrapper del formulario completo -->
